# Esp32é”®ç›˜


<img src="https://github.com/kazawan/notion_note/blob/main/Arduino%20Esp32/Esp32%E9%94%AE%E7%9B%98/B3A1F484-B230-43D2-A1D7-F499F3937CD9.jpeg" width="400px" alt="æˆå“" >

- [x]  æŒ‰é”®å†²çª

      ä½¿ç”¨keypad.h ä¸­çš„multiKey 

- [x]  è“ç‰™è¿æ¥ä¸ç¨³å®š
- [x]  æŒ‰é”®åé¦ˆä¸å¤Ÿæ˜æ˜¾
- [x]  æŒ‰é”®æ¾åŠ¨
- [x]  é—´è·å¤ªå¤§ ç»æµ‹é‡æ˜¯18mmé—´è· æ›´æ­£ï¼š19.05mm
- [x]  4*5 çŸ©é˜µ
- [x]  å·¦ä¸Šè§’åŠŸèƒ½é”®
    
    ä½¿ç”¨layerState çŠ¶æ€åˆ¤æ–­
    
    - [ ]  å°è¯•ä¸€ä¸‹æšä¸¾ï¼Œå› ä¸ºå¯èƒ½ä¼šæœ‰å¾ˆå¤šé¡µé¢
- [ ]  è®¾è®¡å¤–å£³
- [ ]  ä½åŠŸè€—
- [ ]  Ws2812ç¯å…‰æ•ˆæœ
- [ ]  Webclient ä¸Šä½æœºåç«¯æ”¹é”®
- [ ]  Electron vue3å‰ç«¯
- [ ]  éœ‡åŠ¨é©¬è¾¾ drv2605
- [ ]  0.91 oled
- [ ]  æ»šè½®ç¼–ç 

pcbé«˜åº¦1.6mm

esp32 é«˜åº¦3.2mm

åœ°æ¿é«˜åº¦2mm

æ€»é«˜åº¦  6.8mm

èºæ¯é«˜åº¦ 2.2-2.3mm

1.6 5 2  8.6

## ğŸ“’å‚è€ƒ

### âš’ï¸ç¡¬ä»¶

ã€ã€é›¶åŸºç¡€ã€‘å®¢åˆ¶åŒ–é”®ç›˜DIYç³»åˆ—æ•™ç¨‹ï¼ˆä¸‰ï¼‰å¦‚ä½•ç”»å‡ºè‡ªå·±é”®ç›˜çš„å®šä½æ¿-å“”å“©å“”å“©ã€‘ [https://b23.tv/QEcCTsh](https://b23.tv/QEcCTsh)

ã€ã€æœºæ¢°é”®ç›˜DIYã€‘çœŸæ­£ä»é›¶å¼€å§‹ è®¾è®¡åˆ¶ä½œä¸€æ¬¾å¤šåª’ä½“æœºæ¢°é”®ç›˜-å“”å“©å“”å“©ã€‘ [https://b23.tv/xHAkwg](https://b23.tv/xHAkwgm)

ã€ã€æ–°æ‰‹å‘ã€‘è‡ªåˆ¶åŒ–é”®ç›˜ç¬¬ä¸€æœŸâ€”â€”é…åˆ—/å®šä½æ¿/åŸºç¡€å›ºä»¶-å“”å“©å“”å“©ã€‘ [https://b23.tv/n3m7tgR](https://b23.tv/n3m7tgR)

### ğŸ¦è½¯ä»¶

****ã€ŠESP32 å­¦ä¹ ç¬”è®°ã€‹ ä¹‹ ESP32 æ¨¡æ‹Ÿ è“ç‰™é”®ç›˜-Keyboard**** [https://blog.csdn.net/qq_41868901/article/details/106203642](https://blog.csdn.net/qq_41868901/article/details/106203642)

### ğŸ”¨é”®é…åˆ—ç½‘å€

[http://www.keyboard-layout-editor.com/#/](http://www.keyboard-layout-editor.com/#/)

### é›¶ä»¶

ã€æ·˜å®ã€‘[https://m.tb.cn/h.UICYr2W?tk=aWokdPLx0HV](https://m.tb.cn/h.UICYr2W?tk=aWokdPLx0HV) CZ3457 ã€Œå‡¯åæ”¹è£…æœºæ¢°é”®ç›˜è‡ªä¸»ç³»åˆ—æ’æ‹”è½´ã€

| ç±»å‹ | é“¾æ¥ |
| --- | --- |
| ç¡¬ä»¶ |  |
| å®¢åˆ¶åŒ–é”®ç›˜DIYç³»åˆ—æ•™ç¨‹ï¼ˆä¸‰ï¼‰å¦‚ä½•ç”»å‡ºè‡ªå·±é”®ç›˜çš„å®šä½æ¿-å“”å“©å“”å“© | https://b23.tv/QEcCTsh |
| çœŸæ­£ä»é›¶å¼€å§‹è®¾è®¡åˆ¶ä½œä¸€æ¬¾å¤šåª’ä½“æœºæ¢°é”®ç›˜-å“”å“©å“”å“© | https://b23.tv/xHAkwg |
| æ–°æ‰‹å‘è‡ªåˆ¶åŒ–é”®ç›˜ç¬¬ä¸€æœŸâ€”â€”é…åˆ—/å®šä½æ¿/åŸºç¡€å›ºä»¶-å“”å“©å“”å“© | https://b23.tv/n3m7tgR |
| è½¯ä»¶ |  |
| ã€ŠESP32 å­¦ä¹ ç¬”è®°ã€‹ ä¹‹ ESP32 æ¨¡æ‹Ÿ è“ç‰™é”®ç›˜-Keyboard | https://blog.csdn.net/qq_41868901/article/details/106203642 |
| é›¶ä»¶ |  |
| CZ3457 ã€Œå‡¯åæ”¹è£…æœºæ¢°é”®ç›˜è‡ªä¸»ç³»åˆ—æ’æ‹”è½´ã€ | https://m.tb.cn/h.UICYr2W?tk=aWokdPLx0HV |
| é…ç½®ç½‘ç«™ |  |
| é”®é…åˆ—ç½‘ç«™ | http://www.keyboard-layout-editor.com/#/ |
| å®šä½æ¿ç½‘ç«™ | http://builder.swillkb.com/ |
| Edaè®¾ç½®ç½‘æ ¼æ–¹æ³•å¯¹é½ | https://www.zfrontier.com/app/flow/40KBkWGrmMz3 |
| KEYPAD å¤šæŒ‰é”®åŒæ—¶ä½¿ç”¨æ–¹æ³• | https://github.com/Chris--A/Keypad/blob/master/examples/MultiKey/MultiKey.ino |
| qmk çŸ©é˜µè¿çº¿æ–¹æ³• | https://kbfirmware.com/ |

é”®ç›˜è¿æ¥

```jsx
[
	['fn','*','/','-'],
	['7','8','9','+'],
	['4','5','6'],
	['1','2','3'],
	['0','.','enter'],
]
```

![Untitled](Esp32%E9%94%AE%E7%9B%98%20f032537d01eb4722bc5ad22e6ea5415d/Untitled.png)

### ble_Keyboard åŠ¨æ€æ£€æµ‹æŒ‰é”®

```jsx
void keypadEvent(KeypadEvent key){
   switch (kpd.getState()){
    case PRESSED:
        break;

    case RELEASED:
        if (key == '1') {
            bleKeyboard.release(KEY_MEDIA_VOLUME_DOWN);
        }
        if(key == '2'){
          bleKeyboard.release(KEY_MEDIA_VOLUME_UP);
        }
        break;

    case HOLD:
        if (key == '1') {
            
            bleKeyboard.press(KEY_MEDIA_VOLUME_DOWN);
        }
        if(key == '2'){
          bleKeyboard.press(KEY_MEDIA_VOLUME_UP);
        }
        break;
    }
}

void setup(){
	kpd.addEventListener(keypadEvent); // add an event listener for this keypad
  kpd.setHoldTime(200); // è®¾ç½®æŒ‰é”®ä¿æŒæ—¶é—´
  kpd.setDebounceTime(10); // è®¾ç½®æŒ‰é”®å»æŠ–æ—¶é—´

}
```

`ä»£ç å¤‡ä»½`

```jsx
#include <Arduino.h>
// #include <WiFi.h>
// #include <webserver.h>
#include <BleKeyboard.h>

#define led 2
#define key 14
#define CTRL 0x80

// const char *ssid = "K'S_HOME";
// const char *password = "00189423";

// WebServer server(80);

// void handleRoot() {
//   server.send(200, "text/plain", "hello from esp32!");
// }

// void postHandler() {
//   String body = server.arg("plain");
//   Serial.println(body);
//   if (body == "on") {
//     digitalWrite(led, HIGH);
//   } else if (body == "off") {
//     digitalWrite(led, LOW);
//   }
//   server.send(200, "text/plain", "ok");
// }

// String msg = "hello world";
// void keyChange(){
//   String body = server.arg("plain");
//   msg = body;
//   server.send(200, "text/plain", "ok");
// }

BleKeyboard bleKeyboard("ESP32 Keyboard");

void setup()
{
  Serial.begin(115200); // åˆå§‹åŒ–ä¸²å£
  pinMode(led, OUTPUT); // è®¾ç½®ledå¼•è„šä¸ºè¾“å‡º
  pinMode(key, INPUT_PULLUP); // è®¾ç½®keyå¼•è„šä¸ºè¾“å…¥

  // WiFi.begin(ssid, password);// è¿æ¥åˆ°WiFi
  // while (WiFi.status() != WL_CONNECTED) {
  //   delay(500);
  //   Serial.println("Connecting to WiFi..");
  // }
  // Serial.println(WiFi.localIP().toString());
  // server.enableCORS();
  bleKeyboard.begin();
}

int lastTime = 0;

// boolean keypress(int *key){

//   if (digitalRead() == LOW) {
//     if (millis() - lastTime > 1000) {
//       lastTime = millis();
//       return true;
//     }
//   }
//   return false;
// }

// boolean blueConnected(){
//   int bluestate = 0;
//   if (bleKeyboard.isConnected()) {
//     if(bluestate == 1 ){
//       Serial.println("connected");
//       bluestate = 0;
//     }

//     return true;
//   }
//   bluestate = 1;
//   return false;
// }

void keyPress(){
  // Serial.println( lastTimes);
  if (digitalRead(key) == LOW)
    {   
      if (millis() - lastTime > 150)
      {
        Serial.println("key pressed");
        bleKeyboard.print("kazawan");
        // todo ctrl+v
        // bleKeyboard.press(CTRL);
        // bleKeyboard.press('v');
        bleKeyboard.releaseAll();
        lastTime = millis();
      }
    }
}

void keyPress2(int *t){
  // Serial.println( lastTimes);
  int tt = *t;
  if (digitalRead(key) == LOW)
    {   
      if (millis() - tt > 150)
      {
        Serial.println("key pressed");
        bleKeyboard.print("kazawan");
        tt = millis();
        *t = tt;
      }
    }
}

void loop()
{
  // æœåŠ¡å™¨å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚
  // server.handleClient();

  // if (millis() - lastTime > 1000) {
  if (bleKeyboard.isConnected())
  {
    
    digitalWrite(led, HIGH);
    // if (digitalRead(key) == LOW)
    // {
    //   if (millis() - lastTime > 150)
    //   {
    //     Serial.println("key pressed");
    //     bleKeyboard.print("kazawan");
    //     lastTime = millis();
    //   }
    // }
    // keyPress();
    keyPress2(&lastTime);
    
  }else{
    digitalWrite(led, LOW);
  }
}
```

```
[
    ['esc', 'F1', 'F2', 'F3', 'F4', 'F5', 'F6', 'F7', 'F8', 'F9', 'F10', 'F11', 'F12', 'prt sc', 'scroll lock', 'pause'],
    ['~', '!', '@', '#', '$', '%', '^', '&', '*', '(', ')', '_', '+', 'backspace'],
    ['tab', 'Q', 'W', 'E', 'R', 'T', 'Y', 'U', 'I', 'O', 'P', '{', '}', '|', 'delete'],
    ['caps lock', 'A', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L', ':', '"', 'enter'],
    ['shift', 'Z', 'X', 'C', 'V', 'B', 'N', 'M', '<', '>', '?', 'shift'],
    ['ctrl', 'fn', 'alt', 'space', 'alt', 'left', 'down', 'up', 'right', 'ctrl']
]

```

å°†åŸæ¥çš„6è¡Œ16åˆ—é”®ç›˜è°ƒæ•´ä¸º8è¡Œ9åˆ—é”®ç›˜ã€‚

| 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| esc | F1 | F2 | F3 | F4 | F5 | F6 | F7 | F8 |
| ~ | ! | @ | # | $ | % | ^ | & | * |
| tab | Q | W | E | R | T | Y | U | I |
| caps lock | A | S | D | F | G | H | J | K |
| shift | Z | X | C | V | B | N | M | del |
| ctrl | alt | space | alt | fn | left | down | up | right |

| 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| esc |  |  |  |  |  |  |  |  |
| ~ | ! | @ | # | $ | % | ^ | & | * |
| tab | Q | W | E | R | T | Y | U | I |
| caps lock | A | S | D | F | G | H | J | K |
| shift | Z | X | C | V | B | N | M | del |
| ctrl | alt | space | alt | fn | left | down | up | right |

```jsx
[
[]
]
```
